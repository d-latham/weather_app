@page "/astro"
@using WeatherApp.Models;
@using WeatherApp.Clients;

@inject WeatherClient WeatherClient;
<div style="display: flex; justify-content: center;">
<div style="width: 70%; max-width: 800px; padding: 20px;">
<h1 class="title" style="font-size: 2rem; font-family: Arial, sans-serif; display: flex; justify-content: center;">Astronomy of the Day</h1>
@code {
    DateTime newdate = DateTime.Today;
}
<div class="form-group">
    <label class="form-label" for="exampleFormControlInput1"> Enter your City/Zip Code</label>
    <input type="text" class="form-control" id="exampleFormControlInput1" placeholder="Ex: Columbus or 31907" @bind-value="newLocation" />
    <label class="form-label" for="exampleFormControlInput1">Date</label>
    <InputDate class="form-control" style="width: 200px; border: 2px solid #6aabf1;" format="yyyy-MM-dd" id="newdate" @bind-Value="@newdate" />
</div>


<button class="btn btn-primary" @onclick="selectLocation">Submit</button>
<div class="output-box" style="text-align: center;">
    <h2 class="display-6" style="font-size: 1.5rem; font-family: Arial, sans-serif;display: flex; justify-content: center">You are here at @response.location.name!</h2>

@if (response != null && response.astronomy != null)
{
    var astro = response.astronomy.astro;
    <div class="row">
        <div class="col-sm-3">
            <img class="weather-icon" src="https://static.thenounproject.com/png/5680821-200.png" alt="Sunrise" />
            <h4 style="font-size: 1.2rem; font-family: Arial, sans-serif; color: #0069d9 ;">Sunrise</h4>
            <p>@astro.sunrise</p>
        </div>
        <div class="col-sm-3">
            <img class="weather-icon" src="https://static.thenounproject.com/png/3816464-200.png" alt="Moonrise" />
            <h4 style="font-size: 1.2rem; font-family: Arial, sans-serif;color: #0069d9 ;">Moonrise</h4>
            <p>@astro.moonrise</p>
        </div>
        <div class="col-sm-3">
            <img class="weather-icon" src="https://static.thenounproject.com/png/2611472-200.png" alt="Sunset" />
            <h4 style="font-size: 1.2rem; font-family: Arial, sans-serif;color: #0069d9 ;">Sunset</h4>
            <p>@astro.sunset</p>
        </div>
        <div class="col-sm-3">
            <img class="weather-icon" src="https://static.thenounproject.com/png/971154-200.png" alt="Moonset" />
            <h4 style="font-size: 1.2rem; font-family: Arial, sans-serif;color: #0069d9 ;">Moonset</h4>
            <p>@astro.moonset</p>
        </div>
    </div>
}
<style>
    .weather-icon {
        width: 50px;
        height: 50px;
    }
</style>
</div>
</div>
</div>

@code {
    private WeatherResponse? weatherResponse = null;
    public WeatherResponse? response = null;
    public string? newLocation;

    protected override async Task OnInitializedAsync()
    {
        weatherResponse = await WeatherClient.getWeather("astronomy", null, "1", null);
        response = weatherResponse;
    }

    async Task selectLocation()
    {
        weatherResponse = await WeatherClient.getWeather("astronomy", newLocation, "1", newdate.ToShortDateString());
        response = weatherResponse;
        newLocation = string.Empty; 
    }
}
